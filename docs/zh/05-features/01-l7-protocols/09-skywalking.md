---
title: SkyWalking
permalink: /features/l7-protocols/skywalking
---

通过解析 SkyWalking sw8 协议，将 SkyWalking 协议的数据结构的字段映射到 l7_flow_log 对应字段中，映射关系如下表：

**Tag 字段映射表格，以下表格只包含存在映射关系的字段**

| 名称                 | 中文           | SkyWalking 数据结构                                                                                                                                                                                                                                 | 描述                                                                                    |
|--------------------|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| start_time         | 开始时间         | span.startTime                                                                                                                                                                                                                                  | --                                                                                    |
| end_time           | 结束时间         | span.endTime                                                                                                                                                                                                                                    | --                                                                                    |
| protocol           | 网络协议         | TCP                                                                                                                                                                                                                                             | 固定枚举值                                                                                 |
| attributes         | 标签           | span.tags                                                                                                                                                                                                                                       | --                                                                                    |
| ip                 | IP 地址        | --                                                                                                                                                                                                                                              | 从上游 SkyWalking Agent 发送数据源获取                                                          |
| l7_protocol        | 应用协议         | span.tags.[db.type/http.scheme/db.system/rpc.system/messaging.system/messaging.protocol]                                                                                                                                                        | 如果有任何 `http.` 开头的 tags，则标记为 HTTP 协议，否则尝试从 span.tags 中获取                               |
| l7_protocol_str    | 应用协议         | span.tags.[db.type/http.scheme/db.system/rpc.system/messaging.system/messaging.protocol]                                                                                                                                                        | 先从 l7_protocol 中尝试转换为描述，如果无法转换则直接记录为 tag value                                        |
| version            | 协议版本         | span.tags.http.flavor                                                                                                                                                                                                                           | --                                                                                    |
| type               | 日志类型         | SESSION                                                                                                                                                                                                                                         | 固定枚举值                                                                                 |
| request_type       | 请求类型         | span.tags.[http.method/cache.cmd/db.operation/rpc.method]                                                                                                                                                                                       | --                                                                                    |
| request_domain     | 请求域名         | span.tags.[http.host/db.connection_string]                                                                                                                                                                                                      | --                                                                                    |
| request_resource   | 请求资源         | span.endpointName/span.tags.[http.target/db.statement/messaging.url/rpc.service/cache.key]                                                                                                                                                      | span.tags.http.target 如果存在则读取，不存在则从 http.url 截断取, 仅提取域名之后的调用信息                        |
| request_id         | 请求 ID        | --                                                                                                                                                                                                                                              |                                                                                       |
| response_status    | 响应状态         | 根据 response_code 尝试转换，若无法转换，获取 span.isError，若为 true: STATUS_SERVER_ERROR，否则 STATUS_SERVER_OK                                                                                                                                                    | --                                                                                    |
| response_code      | 响应码          | span.tags.[status_code/http.status_code/status.code]                                                                                                                                                                                            | 优先使用 span.tags.http.status_code                                                       |
| response_exception | 响应异常         | 根据 response_code 转换对应异常描述                                                                                                                                                                                                                       | --                                                                                    |
| app_service        | 服务名称         | segment.service                                                                                                                                                                                                                                 | --                                                                                    |
| app_instance       | 服务实例         | segment.serviceInstance                                                                                                                                                                                                                         | --                                                                                    |
| endpoint           | 端点           | span.operationName                                                                                                                                                                                                                              | --                                                                                    |
| trace_id           | TraceID      | span.traceID                                                                                                                                                                                                                                    | --                                                                                    |
| span_id            | SpanID       | span.TraceSegmentID-span.spanID                                                                                                                                                                                                                 | --                                                                                    |
| parent_span_id     | ParentSpanID | segment.ID-span.parentSpanID/span.ref.parentTraceSegmentID-span.ref.parentSpanID                                                                                                                                                                | 优先 segment.ID-span.parentSpanID，若 span.parentSpanID = -1 则从 span.ref 中获取 ParentSpanID |
| span_kind          | Span 类型      | span.spanType.Exit: SPAN_KIND_CLIENT, span.spanType.Entry: SPAN_KIND_SERVER, span.spanType.Local: SPAN_KIND_INTERNAL, span.spanType.Entry && span.spanLayer.MQ: SPAN_KIND_CONSUMER, span.spanType.Exit && span.spanLayer.MQ: SPAN_KIND_PRODUCER | --                                                                                    |
| events             | 事件           | --                                                                                                                                                                                                                                              | --                                                                                    |
| observation_point  | 观测点          | span.spanType.Exit: 客户端应用(C-APP), span.spanType.Entry: 服务端应用(S-APP), span.spanType.Local: 应用(APP)                                                                                                                                               | --                                                                                    |
