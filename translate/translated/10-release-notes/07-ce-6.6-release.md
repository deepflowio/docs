---
title: v6.6 CE Release Notes
permalink: /release-notes/release-6.6-ce
---

> This document was translated by ChatGPT

# Backport From 7.0

- AutoTracing
  - [2025/01/02] Support collection and tracing of the Tars protocol, [documentation](../features/l7-protocols/rpc/#tars).
  - [2025/01/16] For non-TCP traffic in network flow logs (`l4_flow_log`), change the end status (`close_type`) from timeout to normal end (1).
  - [2025/04/02] Support collection and tracing of the Ping protocol, [documentation](../features/l7-protocols/network/#ping).
  - [2025/04/02] Support collection and tracing of the Dubbo protocol when using Fastjson serialization, [documentation](../features/l7-protocols/rpc/#dubbo).
  - [2025/04/15] Support parsing MySQL Login Response statements.
  - [2025/04/15] Support parsing multiple DNS requests in a TCP Payload.
  - [2025/04/28] Enrich eBPF hook points for collecting file read/write events (`io_event`) to improve adaptability.
  - [2025/05/29] Support collecting Unix Socket call logs (`l7_flow_log`) and automatic tracing between TCP/UDP Socket call logs and Unix Socket call logs.
  - [2025/05/29] Support parsing SRV type DNS call logs, [documentation](https://en.wikipedia.org/wiki/SRV_record).
  - [2025/05/29] Support parsing truncated MySQL protocol content.
- AutoTagging
  - [2025/04/28] Optimize the meaning of the `process_kname` field in call logs and file read/write event data, changing from `kernel thread name` to `system process` name for better readability.
  - [2025/04/28] Aggregate processes with the same `cmdline` within the same cloud host or the same K8s workload into a unique gprocess to reduce redundant process information.
  - [2025/04/28] Optimize default values for the process matcher, [documentation](../configuration/agent/#inputs.proc.process_matcher).
    - By default, ignore collection of process information for `sleep/sh/bash/pause/runc`.
    - By default, collect process information and OnCPU profiling data for `Java/Python`, and automatically record the gprocess name as the jar/py file name to avoid all being displayed as java/python.
    - By default, collect process information and OnCPU profiling data for `deepflow-*`.
    - By default, collect process information in containers.
  - [2025/04/28] Optimize the meaning of the `response_status` field in call logs (`l7_flow_log`).
    - **Normal**: Response code is normal.
    - **Client Error**: Response code indicates a client-side error, e.g., HTTP 4XX.
    - **Server Error**: Response code indicates a server-side error, e.g., HTTP 5XX.
    - **Timeout**: If no response is collected within a certain time, the request is marked as timed out.
      - Agent `Application session merge timeout` configuration: DNS and TLS default 15s, other protocols default 120s, [documentation](../configuration/agent/#processors.request_log.timeouts.session_aggregate).
    - **Unknown**: When concurrent requests exceed the collector's cache capacity, the oldest requests are marked as unknown.
      - Agent `Maximum session aggregation entries` configuration: Default cache of 64K requests, [documentation](../configuration/agent/#processors.request_log.tunning.session_aggregate_max_entries).
    - **Parse Failed**: Response was collected but the response code could not be parsed due to truncation or compression.
      - Agent `Payload truncation` configuration: Default parses the first 1024 bytes of the Payload, [documentation](../configuration/agent/#processors.request_log.tunning.payload_truncation).
  - [2025/06/11] Optimize parsing of unary type gRPC calls, [documentation](../configuration/agent/#processors.request_log.application_protocol_inference.protocol_special_config.grpc.streaming_data_enabled).
  - [2025/08/21] Support collecting multiple HTTP2/gRPC requests and responses in a single packet.
  - [2025/08/21] Support obtaining the full file path for file read/write events:
    - Fully obtain NAS file paths, supporting NFS, SMB, CIFS, and other protocols.
    - Fully obtain the absolute path for file read/write inside container Pods.
- AutoMetrics
  - [2025/08/21] Support aggregation to generate eBPF profiling metric data with 1s granularity to speed up profiling metric queries.
- AutoTagging
  - [2025/08/21] Simplify process sync blacklist configuration, [documentation](../configuration/agent/#inputs.proc.process_blacklist).
  - [2025/08/21] Adapt to K8s v1.32+ API.
- Server
  - [2025/02/11] Support terminating remote upgrades of collectors and optimize CPU resource usage of the Server during upgrades.
- Agent
  - [2025/02/11] Support limiting the number of sockets used by deepflow-agent, [documentation](../configuration/agent/#global.limits.max_sockets).
  - [2025/03/18] Support collecting traffic from Pod internal NICs, applicable to scenarios where Pod NIC traffic cannot be directly collected under the Root network namespace (e.g., [Huawei Cloud CCE Turbo CNI](https://support.huaweicloud.com/usermanual-cce/cce_10_0284.html)), [documentation](../configuration/agent/#inputs.cbpf.af_packet.inner_interface_capture_enabled).
  - [2025/04/15] Limit the bandwidth consumption of data sent by the agent, default allowing 100Mbps, [documentation](../configuration/agent/#global.communication.max_throughput_to_ingester).
  - [2025/04/28] Optimize memory usage of the cache for application performance metrics in the Agent by timely cleaning up expired LRU entries, reducing overall memory consumption by **43%** in test environments.
  - [2025/04/28] Aggregate and store flow logs (`l4_flow_log`) generated by LB health checks, reducing flow log storage overhead by nearly **50%** in some production environments, [documentation](../configuration/agent/#outputs.flow_log.aggregators.aggregate_health_check_l4_flow_log).
  - [2025/04/28] Optimize resource overhead protection mechanism when application protocol recognition fails to avoid mistakenly disabling application protocol parsing, [documentation](../configuration/agent/#processors.request_log.application_protocol_inference.inference_max_retries).
  - [2025/05/16] Support compressed transmission of call logs and flow logs, with a compression ratio of up to 8:1 in test environments, [documentation](../configuration/agent/#outputs.compression.l7_flow_log).
  - [2025/05/29] When Agent traffic reaches the rate limit, support choosing between `drop` or `wait` strategies; default is drop, can be configured to wait to improve data transmission success rate, [documentation](../configuration/agent/#global.communication.ingester_traffic_overflow_action).
  - [2025/06/11] Add a circuit breaker mechanism for free disk space in the Agent runtime environment, [documentation](../configuration/agent/#global.circuit_breakers.free_disk).
  - [2025/06/11] Support disabling Agent's use of swap memory, [documentation](../configuration/agent/#global.tunning.swap_disabled).
  - [2025/06/11] Adapt to K8s CNI with identical MAC addresses for virtual NICs on the same host.
  - [2025/06/11] Optimization: Reduce work done by the Agent when disabled.
  - [2025/08/21] Support Watchdog mechanism to ensure circuit breakers execute properly in extreme cases.
  - [2025/08/21] Support compressed transmission of application logs, with compression ratios between 5:1 and 20:1, [documentation](../configuration/agent/#outputs.compression.application_log).

# v6.6.9 [2024/12/12]

## Stable Feature

- AutoTracing
  - Support collection and tracing of the Memcached protocol, [documentation](../features/l7-protocols/nosql/#memcached).
  - cBPF data supports Tars protocol parsing, [documentation](../features/l7-protocols/rpc/#tars).
  - File read/write events support collecting the full path of file names and the offset of read/write files.
- AutoProfiling
  - Support CPU performance profiling for Python and CUDA.
  - Optimize Java process symbol table synchronization mechanism, reducing transient CPU consumption introduced to business processes by about 50%.
  - Improve function stack merging efficiency, reducing resource overhead for function stack reporting, with significant performance improvement in scenarios with many threads of the same name.
- AutoTagging
  - When TraceID exists in the protocol header, support disabling eBPF syscall_trace_id calculation (via `syscall_trace_id_disabled`) to reduce impact on business performance.
  - Support completely disabling cBPF data collection (by setting `tap_interface_regex` to an empty string) to reduce memory overhead.
  - Enhance process synchronization capability, [documentation](../configuration/agent/#inputs.proc.process_matcher).
    - Support synchronizing only processes inside containers.
    - Support not synchronizing Socket information (only process information).
  - When a region whitelist is configured for the cloud platform (Domain), calling the Region API is no longer required.
  - Failure to obtain NAT gateway, routing table, or load balancer information from Alibaba Cloud or Tencent Cloud will not affect synchronization of other resource information.
- Server
  - Optimize storage performance of `genesis*` related MySQL tables.
  - Support using ByConity instead of ClickHouse, [documentation](../best-practice/storage-engine-use-byconity/).
  - Support using ClickHouse Enterprise Edition (currently only supported on Alibaba Cloud), [documentation](https://www.aliyun.com/product/apsaradb/clickhouse).
- Agent
  - Support compressed transmission of profiling data, reducing bandwidth consumption by 30%.
  - Application log data supports compressed transmission, reducing bandwidth consumption by 95% (CPU consumption increases by 3%).
  - Support deepflow-agent using a single socket to transmit all observability data, and allow disabling this feature via `multiple_sockets_to_ingester` to use multiple sockets for improved transmission performance.
  - When BTF (BPF Type Format) is enabled on Linux, and the kernel is >= [5.5](https://github.com/torvalds/linux/commit/f1b9509c2fb0ef4db8d22dac9aef8e856a5d81f6) on X86 architecture or >= [6.0](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=linux-6.0.y&id=efc9909fdce00a827a37609628223cd45bf95d0b) on ARM architecture, the agent will automatically use fentry/fexit instead of kprobe/kretprobe, resulting in about 15% performance improvement.
  - The original environment variable `ONLY_WATCH_K8S_RESOURCE` has been replaced with `K8S_WATCH_POLICY`, [documentation](../ce-install/serverless-pod/#部署-deepflow-agent).

# v6.6.8 [2024/11/14]

## Stable Feature

- Server
  - By default, aggregate and generate network performance metrics and application performance metrics with granularity of 1h and 1d.
- Agent
  - Configuration refactoring, [documentation](../configuration/agent/).

# v6.6.7 [2024/10/31]

## Beta Feature

- AutoTagging
  - Enhance process synchronization capability, [documentation](../configuration/agent/#inputs.proc.process_matcher).
    - Support synchronizing only processes inside containers.
    - Support not synchronizing Socket information (only process information).

# v6.6.6 [2024/10/11]

## Backward Incompatible Change

- AutoTracing
  - To reduce resource overhead and avoid misidentification, the agent will by default only parse the following application protocols (to enable parsing of other protocols, configure `l7-protocol-enabled`):
    - HTTP, HTTP2/gRPC, MySQL, Redis, Kafka, DNS, TLS.
    - Reminder: When using Wasm to parse private protocols, please add Custom to `l7-protocol-enabled`.

## Stable Feature

- Agent
  - Support specifying and disabling K8s List & Watch via environment variables (thanks to `Hyzhou`: [FR](https://github.com/deepflowio/deepflow/issues/5404), [FR](https://github.com/deepflowio/deepflow/issues/7965)).
  - Reduce eBPF memory overhead of the Agent (thanks to `qyzhaoxun`: [FR](https://github.com/deepflowio/deepflow/issues/8028)).

# v6.6.5 [2024/09/24]

## Beta Feature

- AutoProfiling
  - Optimize Java process symbol table synchronization mechanism, reducing transient CPU consumption introduced to business processes by about 50%.
  - Improve function stack merging efficiency, reducing resource overhead for function stack reporting, with significant performance improvement in scenarios with many threads of the same name.
- Server
  - Optimize storage performance of `genesis*` related MySQL tables.
  - AutoTagging: When a region whitelist is configured for the cloud platform (Domain), calling the Region API is no longer required.
  - AutoTagging: Failure to obtain NAT gateway, routing table, or load balancer information from Alibaba Cloud or Tencent Cloud will not affect synchronization of other resource information.
- Agent
  - When BTF (BPF Type Format) is enabled on Linux, and the kernel is >= [5.5](https://github.com/torvalds/linux/commit/f1b9509c2fb0ef4db8d22dac9aef8e856a5d81f6) on X86 architecture or >= [6.0](https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git/commit/?h=linux-6.0.y&id=efc9909fdce00a827a37609628223cd45bf95d0b) on ARM architecture, the agent will automatically use fentry/fexit instead of kprobe/kretprobe, resulting in about 15% performance improvement.
  - Support compressed transmission of profiling data, reducing bandwidth consumption by 30%.
  - The original environment variable `ONLY_WATCH_K8S_RESOURCE` has been replaced with `K8S_WATCH_POLICY`, [documentation](../ce-install/serverless-pod/#部署-deepflow-agent).

## Stable Feature

- AutoTracing
  - Support enhancing HTTP2/gRPC call logs using Wasm Plugin (currently not supporting enhancement of eBPF uprobe data), [documentation](../integration/process/wasm-plugin/).
- AutoProfiling
  - Support stack unwinding using DWARF when Frame Pointer is missing.
- AutoTagging
  - Support Alibaba Cloud resource synchronization using a regular account's AK/SK with ResourceGroupId.

# v6.6.4 [2024/08/29]

## Beta Feature

- AutoTracing
  - cBPF data supports Tars protocol parsing, [documentation](../features/l7-protocols/rpc/#tars).
- AutoProfiling
  - Support stack unwinding using DWARF when Frame Pointer is missing.
- AutoTagging
  - Support Alibaba Cloud resource synchronization using a regular account's AK/SK with ResourceGroupId.
- Server
  - Support using ByConity instead of ClickHouse, [documentation](../best-practice/storage-engine-use-byconity/).

## Stable Feature

- AutoTracing
  - Automatically correct minor clock drift between different machines in distributed tracing flame graphs.
- AutoTagging
  - Support customizing K8s workload abstraction rules using Lua Plugin, [documentation](../features/auto-tagging/k8s-crd/).
  - Support synchronizing LoadBalancer type container services.
- Server
  - Support using OceanBase instead of MySQL.

# v6.6.3 [2024/08/15]

## Beta Feature

- AutoTracing
  - When TraceID exists in the protocol header, support disabling eBPF syscall_trace_id calculation (via `syscall_trace_id_disabled`) to reduce impact on business performance.
  - Automatically correct minor clock drift between different machines in distributed tracing flame graphs.
- AutoTagging
  - Support customizing K8s workload abstraction rules using Lua Plugin, [documentation](../features/auto-tagging/k8s-crd/).
- Agent
  - Support completely disabling cBPF data collection (by setting `tap_interface_regex` to an empty string) to reduce memory overhead.
  - Support deepflow-agent using a single socket to transmit all observability data, and allow disabling this feature via `multiple_sockets_to_ingester` to use multiple sockets for improved transmission performance.

## Stable Feature

- AutoProfiling
  - Support viewing DeepFlow eBPF On-CPU Profiling data in Grafana Panel, [Demo](https://ce-demo.deepflow.yunshan.net/d/Continuous_Profiling/continuous-profiling?var-app_service=deepflow-server).
- AutoMetrics
  - Support aligning timestamps of request and response metrics within the same session to help AIOps systems better perform root cause analysis (thanks to `pegasusljn`: [FR](https://github.com/deepflowio/deepflow/issues/7069)).
- AutoTagging
  - Correctly tag Universal Tag for loopback NIC traffic on K8s Nodes.
- Agent
  - Reduce the number of sockets used by deepflow-agent when sending data.
    - Merge sockets used for transmitting open_telemetry and open_telemetry_compressed data when integrating with OpenTelemetry.
    - Merge sockets used for agent self-monitoring, transmitting deepflow_stats and agent_log data.
    - Merge sockets used for transmitting prometheus and telegraf metrics when integrating with Prometheus and Telegraf.

# v6.6.2 [2024/08/01]

## Beta Feature

- AutoMetrics
  - Support aligning timestamps of request and response metrics within the same session to help AIOps systems better perform root cause analysis (thanks to `pegasusljn`: [FR](https://github.com/deepflowio/deepflow/issues/7069)).

## Stable Feature

- AutoTracing
  - Optimize default values for NTP clock offset (`host_clock_offset_us`) and network delay (`network_delay_us`) configuration parameters used in network span tracing to reduce mismatch probability.

# v6.6.1 [2024/07/18]

## Beta Feature

- AutoTagging
  - Correctly tag Universal Tag for loopback NIC traffic on K8s Nodes.

## Stable Feature

- AutoTracing
  - Add URL masking capability for HTTP protocol, enable Redis protocol masking by default.
- AutoTagging
  - Support synchronizing Volcano Engine resource tags, [documentation](../features/auto-tagging/meta-tags/).
  - Stop synchronizing Pods in K8s Evicted state to reduce resource overhead.
- Integration
  - Optimize mapping of schema/target and other fields in OTel Span to `l7_flow_log`, [documentation](../features/l7-protocols/otel/).
- Agent
  - Support aggregated collection of traffic from multiple member physical NICs of an Open vSwitch bond interface.

# v6.6.0 [2024/07/04]

## Backward Incompatible Change

- AutoProfiling
  - Use Dataframe return format to compress response size and improve API performance, [PR](https://github.com/deepflowio/deepflow/pull/7011), [documentation](../features/continuous-profiling/data/).

|        | #Functions | Response Size (Byte) | Download Time |
| ------ | ---------- | -------------------- | ------------- |
| Before | 450,000    | 21.9M                | 6.16s         |
| After  | 450,000    | 3.07M                | 0.78s         |

## Beta Feature

- AutoTagging
  - Support synchronizing Volcano Engine resource tags, [documentation](../features/auto-tagging/meta-tags/).
- Agent
  - Support aggregated collection of traffic from multiple member physical NICs of an Open vSwitch bond interface.